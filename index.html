<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NS SIDD TUTORIAL</title>
    <link rel="icon" type="image/png" href="https://github.com/nssidd0/exam/blob/0a2d34aa8d6d7f8bdd6b54bab269979e001f73fb/favicon.png">
    <link rel="shortcut icon" type="image/png" href="https://github.com/nssidd0/exam/blob/0a2d34aa8d6d7f8bdd6b54bab269979e001f73fb/favicon.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#dc2626">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/4712/4712109.png">
    <style>
        body, html { margin:0; padding:0; height:100%; overflow:hidden; }
        iframe { border:none; width:100%; height:100%; }
    </style>
</head>
<body>
    <iframe src="https://script.google.com/macros/s/AKfycbwmUq9IRypwumrkOWxtU0sxcUxRM-GtKaU-JPIwbmS4Y8QHhhNmvyQ8iwOIWptNePooJw/exec" allowfullscreen></iframe>
    <div id="pwaInstallModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/90 backdrop-blur-md p-4">
    <div class="bg-gray-900 border-2 border-red-600 rounded-2xl p-6 max-w-sm w-full text-center shadow-[0_0_50px_rgba(220,38,38,0.5)] relative animate-bounce">
        
        <button id="pwaCloseBtn" class="absolute top-3 right-3 text-gray-400 hover:text-white bg-gray-800 rounded-full w-8 h-8 flex items-center justify-center">
            <i class="fa-solid fa-xmark text-lg"></i>
        </button>

        <div class="w-16 h-16 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
            <i class="fa-solid fa-download text-2xl text-white"></i>
        </div>

        <h3 class="text-xl font-black text-white mb-2">INSTALL APP</h3>
        <p class="text-gray-300 text-sm mb-6">Install <b>NS SIDD TUTORIAL</b> app for faster access and offline mode.</p>

        <button id="pwaInstallBtn" class="w-full bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-500 hover:to-orange-500 text-white font-bold py-3 rounded-xl shadow-lg transition transform active:scale-95 uppercase tracking-wide">
            Install Now ðŸš€
        </button>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  console.log("PWA Script Loaded...");

  // A. Service Worker Register
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log('âœ… Service Worker Registered'))
      .catch((err) => console.log('âŒ SW Error:', err));
  }

  // B. Variables Setup
  let deferredPrompt;
  const installModal = document.getElementById('pwaInstallModal');
  const installBtn = document.getElementById('pwaInstallBtn');
  const closeBtn = document.getElementById('pwaCloseBtn');

  // C. Browser Event Capture
  window.addEventListener('beforeinstallprompt', (e) => {
    console.log("ðŸ”¥ App Install Event Fired!");
    e.preventDefault(); // Default rok do
    deferredPrompt = e; // Event save karo
    
    // 3 Second baad Popup dikhao
    setTimeout(() => {
        console.log("Showing Custom Popup...");
        installModal.classList.remove('hidden');
    }, 3000);
  });

  // D. Install Button Click
  installBtn.addEventListener('click', async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt(); // Asli prompt dikhao
      const { outcome } = await deferredPrompt.userChoice;
      console.log(`User response: ${outcome}`);
      deferredPrompt = null;
      installModal.classList.add('hidden'); // Modal band karo
    }
  });

  // E. Close Button Click
  closeBtn.addEventListener('click', () => {
      console.log("Popup Closed by User");
      installModal.classList.add('hidden');
  });
});
</script>
</body>
</html>
